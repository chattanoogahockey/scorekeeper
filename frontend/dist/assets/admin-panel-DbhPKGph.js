import{G as M,j as s}from"./index-CRuzh1EF.js";import{u as B,b as a}from"./react-vendor-6tIi07-H.js";import{a as m}from"./ui-vendor-NIGUFBhG.js";const U=()=>{const[n,r]=a.useState(null),g="";return a.useEffect(()=>{(async()=>{try{const c=await m.get(`${g}/api/version`,{headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"},params:{t:Date.now()}});console.log("Version info received:",c.data),r(c.data)}catch(c){console.error("Error fetching version from API:",c);try{const i=await fetch(`/version.json?t=${Date.now()}`);if(i.ok){const l=await i.json();console.log("Static version info:",l),r(l)}else throw new Error("Static version file not found")}catch(i){console.error("Error fetching static version:",i),r({version:"1.0.0",commit:"unknown",branch:"unknown",buildTime:"Unknown build time"})}}})()},[]),n?s.jsx("div",{className:"text-sm text-gray-500 bg-gray-100 px-3 py-2 rounded-lg mb-4",children:s.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[s.jsxs("span",{children:[s.jsx("strong",{children:"Version:"})," ",n.version]}),s.jsxs("span",{children:[s.jsx("strong",{children:"Commit:"})," ",n.commit?.substring(0,8)||"unknown"]}),s.jsxs("span",{children:[s.jsx("strong",{children:"Branch:"})," ",n.branch||"unknown"]}),s.jsxs("span",{children:[s.jsx("strong",{children:"Build:"})," ",n.buildTime||"Unknown"]})]})}):null};function F(){const n=B(),{gameData:r}=a.useContext(M),[g,x]=a.useState([]),[c,i]=a.useState(!0),[l,p]=a.useState(null),[b,d]=a.useState(""),[o,f]=a.useState({maleVoice:"",femaleVoice:""}),[v,S]=a.useState([]),h="",[j,y]=a.useState(!1),w=r&&r.team1&&r.team2&&!r.submitted;a.useEffect(()=>{N(),C(),E()},[]);const N=async()=>{try{const e=await m.get(`${h}/api/games/submitted`);x(e.data.data||e.data),i(!1)}catch(e){console.error("Error fetching submitted games:",e),i(!1)}},C=async()=>{try{const e=await m.get(`${h}/api/admin/voice-config`);e.data.success&&f({maleVoice:e.data.config.maleVoice||"en-US-Studio-Q",femaleVoice:e.data.config.femaleVoice||"en-US-Studio-O"})}catch(e){console.error("Error fetching voice config:",e)}},E=async()=>{try{const e=await m.get(`${h}/api/admin/available-voices`);e.data.success&&S(e.data.voices)}catch(e){console.error("Error fetching available voices:",e)}},k=async()=>{y(!0);try{(await m.post(`${h}/api/admin/voice-config`,o)).data.success&&d(`Voice configuration saved! Al: ${o.maleVoice}, Linda: ${o.femaleVoice}`)}catch(e){console.error("Error saving voice config:",e),d(`Error saving voice configuration: ${e.response?.data?.error||e.message}`)}finally{y(!1)}},A=async e=>{const V=g.find(t=>t.id===e),L=`Delete all scoring data for ${V.awayTeam} vs ${V.homeTeam}? This will completely remove the game from the admin panel.`;if(confirm(L)){console.log(`AdminPanel: Attempting to delete game ${e}`),p(e),d("");try{const t=`${h}/api/games/${e}/reset`;console.log(`AdminPanel: Making DELETE request to ${t}`);const u=await m.delete(t);if(console.log("AdminPanel: Delete response:",u.data),u.data.success){x(P=>P.filter(T=>T.id!==e));const G=u.data.message||"Game deletion completed";d(G),console.log("AdminPanel: Refreshing games list..."),setTimeout(async()=>{await N(),console.log("AdminPanel: Games list refreshed from server")},500)}else d("Error: Deletion response indicated failure")}catch(t){console.error("Error deleting game score:",t);const u=t.response?.data?.message||t.response?.data?.error||t.message;d(`Error: ${u}`)}finally{p(null)}}},$=e=>{n(`/admin/edit/${e}`)},D=()=>{n(w?"/ingame":"/")};return s.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Admin Panel"}),s.jsx("button",{onClick:D,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors",children:w?"Back to Game":"Back to Main"})]}),s.jsx(U,{}),b&&s.jsx("div",{className:"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4",children:b})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Announcer Voice Configuration"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Configure which Studio or Neural voices to use for Al (male) and Linda (female) announcements. Studio voices are premium quality, Neural voices are more natural. Players can switch between these during games."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx("span",{className:"text-xl mr-2",children:"ðŸ‘¨"}),"Al (Male Voice)"]}),s.jsx("select",{value:o.maleVoice,onChange:e=>f({...o,maleVoice:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 mb-2",children:v.filter(e=>e.gender==="male").map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx("span",{className:"text-xl mr-2",children:"ðŸ‘©"}),"Linda (Female Voice)"]}),s.jsx("select",{value:o.femaleVoice,onChange:e=>f({...o,femaleVoice:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500 mb-2",children:v.filter(e=>e.gender==="female").map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))})]})]}),s.jsx("div",{className:"mt-6",children:s.jsx("button",{onClick:k,disabled:j,className:"bg-green-500 hover:bg-green-600 disabled:bg-green-300 text-white px-6 py-2 rounded-lg transition-colors",children:j?"Saving...":"Save Voice Configuration"})}),s.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded border",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"Current Configuration:"}),s.jsx("br",{}),"ðŸ‘¨ Al: ",o.maleVoice,s.jsx("br",{}),"ðŸ‘© Linda: ",o.femaleVoice]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"ðŸ’¡ Players can switch between Al and Linda using the buttons in the game interface."})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Completed Games"}),c?s.jsx("p",{className:"text-gray-500",children:"Loading games..."}):g.length===0?s.jsx("p",{className:"text-gray-500",children:"No completed games found."}):s.jsx("div",{className:"space-y-4",children:g.map(e=>s.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold",children:[e.awayTeam," vs ",e.homeTeam]}),s.jsxs("p",{className:"text-gray-600",children:[e.league," League â€¢ ",new Date(e.gameDate).toLocaleDateString()]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Game ID: ",e.id]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>$(e.id),className:"bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg transition-colors",children:"Edit Score"}),s.jsx("button",{onClick:()=>A(e.id),disabled:l===e.id,className:`px-4 py-2 rounded-lg transition-colors text-white ${l===e.id?"bg-red-300 cursor-not-allowed":"bg-red-500 hover:bg-red-600"}`,children:l===e.id?"Deleting...":"Delete Score"})]})]})},e.id))})]})]})})}export{F as default};
